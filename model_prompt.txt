***

### **Prompt for the Model**

**Role:**
Act as a Senior AI & Machine Learning Engineer specializing in Time-Series Forecasting.

**Objective:**
Execute the development of the "Smart Energy Consumption Analysis" internship project. Your goal is to implement **Milestones 1, 2, and 3** at an **advanced level**, focusing strictly on clean, modular code execution and generating high-quality visualizations.

**Workspace Context:**
- **Input Data:** `Dataset/household_power_consumption.txt` (Check for `;` delimiter).
- **Reference Material:** Use `References/PROJECT_SUMMARY.txt` and `References/Milestone_1_2_3_Complete.py` as the "Gold Standard" for implementation details.
- **Project Structure:**
    - `src/` (Module logic)
    - `processed_data/` (Intermediate CSVs)
    - `models/` (Saved models/scalers)
    - `visualizations/` (Output plots)
    - `main.py` (Orchestrator)

**Implementation Tasks:**
Re-implement or refactor the code in `src/` and `main.py` to match the advanced specifications found in the Reference folder:

**1. Data Preprocessing (Milestone 1)**
- **Script:** `src/data_preprocessing.py`
- **Actions:**
    - Load the raw dataset.
    - Handle missing values (Forward/Backward fill) and parse dates.
    - Detect and cap outliers (e.g., at 99th percentile).
    - **Resample** data from minute-level to **Hourly** level.
    - Save the cleaned data to `processed_data/`.
- **Visualization:** Generate and save a "Preprocessing & EDA" plot showing raw vs. cleaned trends.

**2. Advanced Feature Engineering (Milestone 2)**
- **Script:** `src/feature_engineering.py`
- **Actions:**
    - Create the **53 features** described in `PROJECT_SUMMARY.txt`:
        - **Time-based:** Hour, Day, Month, Weekday, Cyclical (Sin/Cos) features.
        - **Lag Features:** 1h, 2h, 3h, 6h, 12h, 24h lags.
        - **Rolling Statistics:** Mean, Std, Min, Max over 3h, 6h, 12h, 24h windows.
        - **Device Ratios:** Kitchen, Laundry, HVAC consumption ratios.
    - Normalize features using `MinMaxScaler`.
    - Split into Train/Val/Test (Time-based split, DO NOT SHUFFLE).
- **Visualization:** Generate and save a "Feature Correlation Heatmap" and "Feature Importance" plot.

**3. Baseline & LSTM Modeling (Milestone 3)**
- **Script:** `src/baseline_model.py`
    - Train a **Linear Regression** model as a baseline.
    - Calculate MAE, RMSE, RÂ².
- **Script:** `src/lstm_model.py`
    - Implement the **High-Performance LSTM Architecture** from the reference:
        - Input Layer (Sequence Length: 24 hours)
        - LSTM Layer 1: 128 units + Dropout(0.2)
        - LSTM Layer 2: 64 units + Dropout(0.2)
        - LSTM Layer 3: 32 units + Dropout(0.2)
        - Dense Output Layer
    - Train with Adam optimizer and Early Stopping.
    - Compare LSTM vs. Linear Regression results.
- **Visualization:**
    - "Model Comparison": Bar chart of RMSE/MAE.
    - "Forecast vs Actual": A clear, attractive line plot showing the model's predictions against actual energy usage for the test period.

**4. Execution & Output**
- Ensure `main.py` runs the full pipeline sequentially and successfully.
- **Do not** generate Git repository files (ignore `.gitignore`, etc.).
- **Do not** write text documentation; focus on the code and the resulting PNG visualizations.

**Design Aesthetic:**
Ensure all generated plots (`visualizations/*.png`) use a professional style (e.g., Seaborn `darkgrid` or a modern palette) that looks impressive and publication-ready.

**Immediate Action:**
Read the current files, verify the dataset format, and write the complete, executable Python code for the modules above.
