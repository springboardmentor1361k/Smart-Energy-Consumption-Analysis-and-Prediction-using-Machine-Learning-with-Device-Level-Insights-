# -*- coding: utf-8 -*-
"""energypreprocessing.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ELSrn6Ul5HVgAMiSilpVog85wJ4Cqa44

#Importing Required Libraries
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

df = pd.read_csv("data.csv", sep=';')
df.head()

df.info()

df['timestamp'] = pd.to_datetime(
    df['Date'] + ' ' + df['Time'],
    dayfirst=True,
    errors='coerce'
)

df['timestamp'].isnull().sum()

df = df.dropna(subset=['timestamp'])

df.drop(['Date', 'Time'], axis=1, inplace=True)
df.set_index('timestamp', inplace=True)

df = df.apply(pd.to_numeric, errors='coerce')
df = df.fillna(method='ffill')

df.info()

hourly_df = df.resample('H').mean()
hourly_df.head()

hourly_df.info()

hourly_df['Global_active_power'].plot(figsize=(12,5))
plt.title("Hourly Global Active Power Consumption")
plt.xlabel("Time")
plt.ylabel("Power")
plt.show()

from sklearn.preprocessing import MinMaxScaler

scaler = MinMaxScaler()
scaled_hourly = scaler.fit_transform(hourly_df)

scaled_hourly_df = pd.DataFrame(
    scaled_hourly,
    index=hourly_df.index,
    columns=hourly_df.columns
)

train_size = int(len(scaled_hourly_df) * 0.8)

train = scaled_hourly_df.iloc[:train_size]
test = scaled_hourly_df.iloc[train_size:]

train.to_csv("train_hourly.csv")
test.to_csv("test_hourly.csv")

